package controller;

import java.sql.SQLException;

import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.scene.control.Button;
import vue.accueil.Main;
import vue.accueil.Main.ButtonAction;

public class ControleurLoginJDBC implements EventHandler<ActionEvent>{

    private Login login;
    private ButtonAction action;
    
    public ControleurLoginJDBC(Login login, ButtonAction action) {
        this.login = login;
        this.action = action;
    }

    @Override
    public void handle(ActionEvent event) {
        Main main = login.getMain();
        switch(action) {
            case CONNEXION:
                    try {
                        boolean connexion = main.getRequetesJDBC().connexion(login.getPseudo().getText(), login.getMdp().getText());
                        if(connexion){

                        }else {
                            Optional<ButtonType> reponse = main.getPopupIncorrect("Mot de passe").showAndWait(); // on lance la fenêtre popup et on attends la réponse
                            if (reponse.isPresent() && reponse.get().equals(ButtonType.OK)){
                                main.afficherAccueil();
                            }
                        }
                    } 
                    catch (SQLException e1) {
                        e1.printStackTrace();
                    }
                    break;
            case INSCRIPTION:
                    try {
                        System.out.println(main.getRequetesJDBC().inscription(login.getPseudo().getText(), login.getMdp().getText(), login.getNom().getText(), login.getPrenom().getText()));
                    } 
                    catch (SQLException e1) {
                        e1.printStackTrace();
                    }
                    break;
        }
    }       
}